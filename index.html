<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Calibri&family=Palatino+Linotype&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Calibri', sans-serif;
            background-color: #f3f4f6;
        }
        h1, h2, h3 {
            font-family: 'Palatino Linotype', serif;
        }
        .section-heading {
            border-bottom: 2px solid #000000;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        .dark-hr {
            border-color: #000000;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8 flex flex-col lg:flex-row gap-8">

    <!-- Input Form Section -->
    <div class="bg-white rounded-xl shadow-lg p-6 flex-1 max-h-screen overflow-y-auto">
        <h2 class="text-3xl font-bold text-gray-800 mb-6">Resume Builder</h2>
        <form id="resumeForm" class="space-y-6">
            <!-- Personal Information -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">PERSONAL INFORMATION</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Full Name</label>
                        <input type="text" id="fullName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" value="John Doe">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Contact Info (Address | Phone | Email)</label>
                        <input type="text" id="contactInfo" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" value="123 Main St, Anytown, USA | (123) 456-7890 | john.doe@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">LinkedIn URL</label>
                        <input type="text" id="linkedin" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" value="https://www.linkedin.com/in/johndoe">
                    </div>
                </div>
            </div>

            <!-- Professional Summary -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">PROFESSIONAL SUMMARY</h3>
                <textarea id="summary" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">A results-driven professional with a strong background in [Your Field]. Skilled in [Key Skills] and experienced in developing innovative solutions. A proven track record of success in [Specific Accomplishments].</textarea>
            </div>

            <!-- Education -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">EDUCATION</h3>
                <div id="education-container" class="space-y-4">
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Degree</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Bachelor of Science in Computer Science">
                        <label class="block text-sm font-medium text-gray-700 mt-2">University</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="State University">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Major/Non-Major</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Major: Computer Science | Minor: Mathematics">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Thesis Topic</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Developing a new algorithm for data compression.">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Dates</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="September 2018 - May 2022">
                        <label class="block text-sm font-medium text-gray-700 mt-2">CGPA</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="3.8/4.0">
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addEducation()">Add Education</button>
            </div>
            
            <!-- Experience -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">EXPERIENCE</h3>
                <div id="experience-container" class="space-y-4">
                     <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Company</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Tech Solutions Inc.">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Role</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Software Developer Intern">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Dates</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="June 2023 - August 2023">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Description (bullet points, one per line)</label>
                        <textarea class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" rows="4">Assisted in the development of a new web application using React.
Collaborated with a team of 5 developers on a major project.
Improved application performance by 15% through code optimization.</textarea>
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addExperience()">Add Experience</button>
            </div>

            <!-- Publications -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">PUBLICATIONS</h3>
                <div id="publications-container" class="space-y-4">
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Title</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="A Novel Approach to AI-Powered Image Recognition">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Authors</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="John Doe, Jane Smith">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Link</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="https://example.com/publication1">
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addPublication()">Add Publication</button>
            </div>

            <!-- Academic Projects -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">ACADEMIC PROJECTS</h3>
                <div id="projects-container" class="space-y-4">
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Project Name</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Facial Recognition Attendance System">
                    </div>
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Project Name</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Online Recipe Generator with Natural Language Processing">
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addProject()">Add Project</button>
            </div>

            <!-- Relevant Skills -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">RELEVANT SKILLS</h3>
                <div id="skills-container" class="space-y-4">
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Category (e.g., "Programming Languages")</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Programming Languages">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Skills (comma separated)</label>
                        <textarea class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" rows="2">Python, Java, C++, JavaScript</textarea>
                    </div>
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Category (e.g., "Programming Languages")</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Frameworks">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Skills (comma separated)</label>
                        <textarea class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" rows="2">TensorFlow, PyTorch, React, Django</textarea>
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addSkill()">Add Skill Category</button>
            </div>

            <!-- Certifications -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">CERTIFICATIONS</h3>
                <div id="certifications-container" class="space-y-4">
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Certification</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="AWS Certified Cloud Practitioner">
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addCertification()">Add Certification</button>
            </div>

            <!-- References -->
            <div>
                <h3 class="text-xl font-bold text-gray-700 section-heading text-center">REFERENCES</h3>
                <div id="references-container" class="space-y-4">
                    <div class="border p-4 rounded-md">
                        <label class="block text-sm font-medium text-gray-700">Full Name</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Dr. Jane Smith">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Title</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Professor">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Department</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="Department of Computer Science">
                        <label class="block text-sm font-medium text-gray-700 mt-2">University</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="State University">
                        <label class="block text-sm font-medium text-gray-700 mt-2">Email</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm" value="jane.smith@university.edu">
                    </div>
                </div>
                <button type="button" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600" onclick="addReference()">Add Reference</button>
            </div>
        </form>
    </div>

    <!-- Resume Preview and Download Section -->
    <div class="bg-white max-w-4xl mx-auto rounded-xl shadow-lg p-6 flex-1">
        <div id="cv-content" class="bg-white">
            <!-- Resume content will be generated here -->
        </div>

        <!-- Download Buttons -->
        <div class="flex justify-center space-x-4 mt-8">
            <button id="downloadPdfBtn" class="bg-red-600 text-white font-bold py-2 px-4 rounded-full shadow-lg hover:bg-red-700 transition duration-300 ease-in-out transform hover:scale-105">
                Download PDF
            </button>
            <button id="downloadDocxBtn" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-full shadow-lg hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105">
                Download DOCX
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.5.0/build/index.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cvContent = document.getElementById('cv-content');
            const form = document.getElementById('resumeForm');

            function updateResume() {
                const fullName = document.getElementById('fullName').value;
                const contactInfo = document.getElementById('contactInfo').value;
                const linkedin = document.getElementById('linkedin').value;
                const summary = document.getElementById('summary').value;

                let html = `
                    <header class="pb-4 border-b-2 border-black mb-4 text-center">
                        <h1 class="text-4xl font-bold text-gray-800">${fullName}</h1>
                        <div class="mt-2 text-sm text-gray-600">
                            <span class="block">${contactInfo}</span>
                            <a href="${linkedin}" class="text-blue-600 hover:underline" target="_blank">${linkedin}</a>
                        </div>
                    </header>
                    <section class="mb-4">
                        <h2 class="text-2xl font-bold text-gray-700 section-heading text-center">PROFESSIONAL SUMMARY</h2>
                        <p class="text-gray-700 leading-relaxed">${summary}</p>
                    </section>
                `;

                // Education Section
                html += `<section class="mb-4"><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">EDUCATION</h2><div class="space-y-2">`;
                document.querySelectorAll('#education-container > div').forEach(div => {
                    const inputs = Array.from(div.querySelectorAll('input, textarea'));
                    html += `
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                            <div class="flex-1">
                                <p class="font-bold text-gray-800">${inputs[0].value}</p>
                                <p class="text-gray-700">${inputs[1].value}</p>
                                <ul class="list-disc list-inside mt-2 text-gray-700">
                                    <li>${inputs[2].value}</li>
                                    <li><span class="font-semibold">Thesis Topic:</span> "${inputs[3].value}".</li>
                                </ul>
                            </div>
                            <div class="mt-2 md:mt-0 md:text-right">
                                <p class="font-semibold text-gray-600">${inputs[4].value}</p>
                                <p class="font-semibold text-gray-600">CGPA: ${inputs[5].value}</p>
                            </div>
                        </div>
                    `;
                });
                html += `</div></section>`;

                // Experience Section
                html += `<section class="mb-4"><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">EXPERIENCE</h2><div class="space-y-2">`;
                document.querySelectorAll('#experience-container > div').forEach(div => {
                    const inputs = Array.from(div.querySelectorAll('input, textarea'));
                    const descriptionItems = inputs[3].value.split('\n').map(item => `<li>${item.trim()}</li>`).join('');
                    html += `
                        <div>
                            <div class="flex justify-between items-center">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">${inputs[0].value}</h3>
                                    <p class="text-gray-700">${inputs[1].value}</p>
                                </div>
                                <p class="text-gray-600">${inputs[2].value}</p>
                            </div>
                            <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                                ${descriptionItems}
                            </ul>
                        </div>
                    `;
                });
                html += `</div></section>`;

                // Publications Section
                html += `<section class="mb-4"><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">PUBLICATIONS</h2><div class="space-y-2 text-gray-700">`;
                document.querySelectorAll('#publications-container > div').forEach(div => {
                    const inputs = Array.from(div.querySelectorAll('input, textarea'));
                    const link = inputs[2].value;
                    const title = link ? `<a href="${link}" target="_blank" class="text-blue-600 hover:underline"><p class="font-medium">${inputs[0].value}</p></a>` : `<p class="font-medium">${inputs[0].value}</p>`;
                    html += `
                        <div>
                            ${title}
                            <p class="text-sm text-gray-600">Authors: ${inputs[1].value}</p>
                        </div>
                    `;
                });
                html += `</div></section>`;

                // Academic Projects
                html += `<section class="mb-4"><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">ACADEMIC PROJECTS</h2><ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">`;
                document.querySelectorAll('#projects-container > div').forEach(div => {
                    const projectName = div.querySelector('input').value;
                    html += `<li>${projectName}</li>`;
                });
                html += `</ul></section>`;

                // Relevant Skills
                html += `<section class="mb-4"><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">RELEVANT SKILLS</h2><div class="space-y-2 text-gray-700">`;
                document.querySelectorAll('#skills-container > div').forEach(div => {
                    const inputs = Array.from(div.querySelectorAll('input, textarea'));
                    html += `<p><span class="font-semibold">${inputs[0].value}:</span> ${inputs[1].value}</p>`;
                });
                html += `</div></section>`;

                // Certifications
                html += `<section class="mb-4"><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">CERTIFICATIONS</h2><ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">`;
                document.querySelectorAll('#certifications-container > div').forEach(div => {
                    const certName = div.querySelector('input').value;
                    html += `<li>${certName}</li>`;
                });
                html += `</ul></section>`;

                // References
                html += `<section><h2 class="text-2xl font-bold text-gray-700 section-heading text-center">REFERENCES</h2><table class="w-full text-gray-700"><tr>`;
                const references = Array.from(document.querySelectorAll('#references-container > div'));
                references.forEach((div, index) => {
                    const inputs = Array.from(div.querySelectorAll('input'));
                    html += `<td class="align-top pr-4">
                        <p class="font-semibold">${inputs[0].value}<br>${inputs[1].value}<br>${inputs[2].value}<br>${inputs[3].value}<br>
                        <strong>Email:</strong> <a href="mailto:${inputs[4].value}" class="text-blue-600 hover:underline">${inputs[4].value}</a></p>
                    </td>`;
                    if ((index + 1) % 2 === 0 && index < references.length - 1) {
                        html += `</tr><tr>`;
                    }
                });
                html += `</tr></table><hr class="mt-4 border-black dark-hr"></section>`;

                cvContent.innerHTML = html;
            }

            form.addEventListener('input', updateResume);
            updateResume(); // Initial render

            // Dynamic form fields
            function addEducation() {
                const container = document.getElementById('education-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelectorAll('input, textarea').forEach(input => input.value = '');
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }
            function addExperience() {
                const container = document.getElementById('experience-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelectorAll('input, textarea').forEach(input => input.value = '');
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }
            function addPublication() {
                const container = document.getElementById('publications-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelectorAll('input, textarea').forEach(input => input.value = '');
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }
            function addProject() {
                const container = document.getElementById('projects-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelector('input').value = '';
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }
            function addSkill() {
                const container = document.getElementById('skills-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelectorAll('input, textarea').forEach(input => input.value = '');
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }
            function addCertification() {
                const container = document.getElementById('certifications-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelector('input').value = '';
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }
            function addReference() {
                const container = document.getElementById('references-container');
                const newField = container.firstElementChild.cloneNode(true);
                newField.querySelectorAll('input, textarea').forEach(input => input.value = '');
                container.appendChild(newField);
                newField.scrollIntoView({ behavior: 'smooth' });
            }

            window.addEducation = addEducation;
            window.addExperience = addExperience;
            window.addPublication = addPublication;
            window.addProject = addProject;
            window.addSkill = addSkill;
            window.addCertification = addCertification;
            window.addReference = addReference;


            const downloadPdfBtn = document.getElementById('downloadPdfBtn');
            const downloadDocxBtn = document.getElementById('downloadDocxBtn');

            // Function to handle PDF download
            if (downloadPdfBtn) {
                downloadPdfBtn.addEventListener('click', () => {
                    const pdfOptions = {
                        margin: [10, 10, 10, 10],
                        filename: `${fullName.value}-CV.pdf`,
                        image: { type: 'jpeg', quality: 0.98 },
                        html2canvas: { scale: 2 },
                        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                    };
                    html2pdf().from(cvContent).set(pdfOptions).save();
                });
            }

            // Function to correctly handle DOCX download
            if (downloadDocxBtn) {
                downloadDocxBtn.addEventListener('click', async () => {
                    const { Document, Packer, Paragraph, TextRun, HeadingLevel } = docx;

                    const parseHtmlToDocx = (htmlElement) => {
                        const paragraphs = [];
                        const children = htmlElement.childNodes;
                        children.forEach(child => {
                            if (child.nodeType === Node.TEXT_NODE) {
                                if (child.textContent.trim() !== '') {
                                    paragraphs.push(new Paragraph({ children: [new TextRun({ text: child.textContent, font: 'Calibri' })] }));
                                }
                            } else if (child.nodeType === Node.ELEMENT_NODE) {
                                if (child.tagName === 'H1') {
                                    paragraphs.push(new Paragraph({ children: [new TextRun({ text: child.textContent, bold: true, size: 48, font: 'Palatino Linotype' })], alignment: docx.AlignmentType.CENTER, spacing: { after: 200 } }));
                                } else if (child.tagName === 'H2') {
                                    paragraphs.push(new Paragraph({ children: [new TextRun({ text: child.textContent, bold: true, size: 36, font: 'Palatino Linotype' })], alignment: docx.AlignmentType.CENTER, spacing: { before: 400, after: 200 } }));
                                } else if (child.tagName === 'H3') {
                                     paragraphs.push(new Paragraph({ children: [new TextRun({ text: child.textContent, bold: true, size: 28, font: 'Palatino Linotype' })] }));
                                } else if (child.tagName === 'P') {
                                    paragraphs.push(new Paragraph({ children: [new TextRun({ text: child.textContent, font: 'Calibri' })] }));
                                } else if (child.tagName === 'UL') {
                                    Array.from(child.children).forEach(li => {
                                        paragraphs.push(new Paragraph({ children: [new TextRun({ text: li.textContent.trim(), font: 'Calibri' })], bullet: { level: 0 } }));
                                    });
                                } else if (child.tagName === 'TABLE') {
                                    Array.from(child.rows).forEach(row => {
                                        const rowParagraphs = [];
                                        Array.from(row.cells).forEach(cell => {
                                            rowParagraphs.push(new Paragraph({ children: [new TextRun({ text: cell.textContent.trim(), font: 'Calibri' })] }));
                                        });
                                        paragraphs.push(...rowParagraphs);
                                    });
                                }
                            }
                        });
                        return paragraphs;
                    };
                    
                    const doc = new Document({
                        sections: [{
                            children: parseHtmlToDocx(cvContent)
                        }]
                    });

                    const blob = await Packer.toBlob(doc);
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `${fullName.value}-CV.docx`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                });
            }
        });
    </script>
</body>
</html>
